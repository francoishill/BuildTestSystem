<Window x:Class="BuildTestSystem.MainWindow"
		xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
		xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
		xmlns:local='clr-namespace:BuildTestSystem'
		Title="Build Test System"
		Height="250"
		Width="525"
		WindowStartupLocation='CenterScreen'
		WindowState='Maximized'
		Loaded='Window_Loaded'>
	<Window.Resources>
		<local:BoolToBrushConverter x:Key='boolToBrushConverter' />
	</Window.Resources>
	<DockPanel LastChildFill='True'>
		<StackPanel Margin='20 10'
					DockPanel.Dock='Bottom'>
			<ProgressBar Name='progressBarIndeterminate'
						 Height='15'
						 IsIndeterminate='True'
						 Visibility='Hidden' />
			<Label Name='statusLabel' />
		</StackPanel>
		<Grid Name='mainContent'>
			<StackPanel Orientation='Horizontal'
						Margin='10'>
				<Button Name='buttonObtainApplicationList'
						Content='Obtain application list'
						VerticalAlignment='Top'
						Height='23'
						Click='buttonObtainApplicationList_Click' />
				<Button Name='buttonBuildAll'
						Content='Build all'
						Height='23'
						Margin='10 0 0 0'
						VerticalAlignment='Top'
						Width='75'
						Click='buttonBuildAll_Click' />
			</StackPanel>
			<ListBox Name='tmpMainListbox'
					 Margin='0 50 0 0'
					 BorderThickness='0'
					 ScrollViewer.CanContentScroll='False'>
				<ListBox.ItemTemplate>
					<DataTemplate>
						<Border Background='{Binding LastBuildResult, Converter={StaticResource boolToBrushConverter}}'
								Margin='5'
								Padding='3'
								CornerRadius='5'
								Focusable='False'
								VerticalAlignment='Top'>
							<Border.ContextMenu>
								<ContextMenu>
									<MenuItem Header='Rebuild this application'
											  Click='contextmenuitemRebuildThisApplication' />
									<MenuItem Header='Open with C# express'
											  Click='contextmenuOpenWithCSharpExpress' />
									<MenuItem Header='Publish Online'
											  Click='contextmenuPublishOnline' />
								</ContextMenu>
							</Border.ContextMenu>
							<DockPanel LastChildFill='True'
									   MaxWidth='800'>
								<Label DockPanel.Dock='Top'
									   Content='{Binding ApplicationName}' />
								<Expander IsExpanded='{Binding HasErrors}'>
									<TextBox Text='{Binding LastBuildFeedback}'
											 ScrollViewer.CanContentScroll='True'
											 ScrollViewer.HorizontalScrollBarVisibility='Auto'
											 ScrollViewer.VerticalScrollBarVisibility='Auto'
											 MaxHeight='300'
											 IsReadOnly='True' />
								</Expander>
							</DockPanel>
						</Border>
					</DataTemplate>
				</ListBox.ItemTemplate>
				<ListBox.ItemContainerStyle>
					<Style TargetType="{x:Type ListBoxItem}">
						<Setter Property="Focusable"
								Value="False" />
					</Style>
				</ListBox.ItemContainerStyle>
				<ListBox.ItemsPanel>
					<ItemsPanelTemplate>
						<WrapPanel IsItemsHost='True'
								   Width='{Binding (FrameworkElement.ActualWidth),
                     RelativeSource={RelativeSource 
                                     AncestorType=ScrollContentPresenter}}'
								   ItemWidth='{Binding (ListView.View).ItemWidth,
                     RelativeSource={RelativeSource AncestorType=ListView}}'
								   ItemHeight='{Binding (ListView.View).ItemHeight,
                     RelativeSource={RelativeSource AncestorType=ListView}}'></WrapPanel>
					</ItemsPanelTemplate>
				</ListBox.ItemsPanel>
			</ListBox>
		</Grid>
	</DockPanel>
</Window>
